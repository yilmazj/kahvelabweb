<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mistik Fal - AI Dostun</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --accent-color: #e94560;
            --text-color: #f1f1f1;
            --gold: #ffd700;
            --secondary: #16213e;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .app-container {
            width: 100%;
            max-width: 400px;
            background-color: var(--secondary);
            height: 100vh;
            position: relative;
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        /* Ekran YÃ¶netimi */
        .screen {
            display: none;
            padding: 20px;
            height: 100%;
            box-sizing: border-box;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .screen.active {
            display: flex;
            animation: fadeIn 0.5s ease;
        }

        /* Login EkranÄ± */
        input, select {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 25px;
            border: none;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 16px;
        }

        /* Butonlar */
        .btn {
            background: linear-gradient(45deg, #e94560, #d63447);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 20px;
            width: 100%;
            font-weight: bold;
            transition: transform 0.2s;
        }
        .btn:active { transform: scale(0.95); }
        .btn-gold { background: linear-gradient(45deg, #ffd700, #b8860b); color: #000; }

        /* Dashboard */
        .credit-badge {
            background: rgba(255, 215, 0, 0.2);
            color: var(--gold);
            padding: 10px 20px;
            border-radius: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--gold);
        }

        /* RitÃ¼el Butonu */
        #ritual-btn {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: radial-gradient(circle, #e94560 0%, #1a1a2e 70%);
            border: 4px solid var(--gold);
            color: white;
            font-size: 14px;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            box-shadow: 0 0 30px rgba(233, 69, 96, 0.5);
            margin-top: 50px;
            position: relative;
        }

        #ritual-btn.holding {
            animation: pulse 1s infinite;
        }

        .progress-ring {
            position: absolute;
            top: -10px; left: -10px; right: -10px; bottom: -10px;
            border-radius: 50%;
            border: 4px solid transparent;
            border-top-color: var(--gold);
            animation: spin 1s linear infinite;
            display: none;
        }

        /* SonuÃ§ EkranÄ± */
        .result-box {
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: left;
            border-left: 3px solid var(--accent-color);
            opacity: 0; /* JS ile aÃ§Ä±lacak */
            transform: translateY(20px);
            transition: all 0.5s ease;
        }
        .result-box.show { opacity: 1; transform: translateY(0); }
        .result-title { color: var(--gold); font-size: 14px; text-transform: uppercase; margin-bottom: 5px; }

        /* Premium Upsell */
        .premium-card {
            background: linear-gradient(135deg, #2a0845 0%, #6441A5 100%);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            border: 1px solid var(--gold);
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<div class="app-container">

    <div id="login-screen" class="screen active">
        <h2>Kimsin Sen Yolcu?</h2>
        <p style="opacity: 0.7;">Enerjini tanÄ±mamÄ±z iÃ§in bilgilerini gir.</p>
        <input type="text" id="username" placeholder="AdÄ±n nedir?">
        <select id="status">
            <option value="">Ä°liÅŸki Durumun</option>
            <option value="single">Sap ve Gururlu</option>
            <option value="complicated">KarmaÅŸÄ±k</option>
            <option value="taken">Mutlu Mesut</option>
            <option value="sad">Kalbi KÄ±rÄ±k</option>
        </select>
        <button class="btn" onclick="app.login()">GiriÅŸ Yap</button>
    </div>

    <div id="dashboard" class="screen">
        <div style="width: 100%; display: flex; justify-content: space-between; align-items: center;">
            <h3>Ana Sayfa</h3>
            <button onclick="app.goToAccount()" style="background:none; border:none; color:white;">ğŸ‘¤ HesabÄ±m</button>
        </div>
        
        <div class="credit-badge">
            Kalan Fal HakkÄ±: <span id="credit-display">3</span>
        </div>

        <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 20px; margin-top: 20px;">
            <p>Kahveni iÃ§tin mi? FincanÄ±n hazÄ±rsa niyetini et ve fotoÄŸrafÄ± gÃ¶nder.</p>
            <button class="btn" onclick="app.startUploadProcess()">â˜• Fal GÃ¶nder</button>
        </div>

        <div class="premium-card" style="margin-top: 40px; transform: scale(0.9);">
            <h4>ğŸš€ Premium'a GeÃ§</h4>
            <p style="font-size: 12px;">DetaylÄ± iliÅŸki analizi ve soru sorma hakkÄ± kazan.</p>
            <button class="btn btn-gold" style="font-size: 14px; padding: 10px;" onclick="app.goToAccount()">Ä°ncele</button>
        </div>
    </div>

    <div id="ritual-screen" class="screen">
        <h3>Enerji AktarÄ±mÄ±</h3>
        <p>FotoÄŸraf yÃ¼klendi. Åimdi parmaÄŸÄ±nÄ± aÅŸaÄŸÄ±daki butona basÄ±lÄ± tut ve niyetine odaklan.</p>
        
        <div id="ritual-btn" 
             onmousedown="ritual.start()" 
             onmouseup="ritual.end()" 
             onmouseleave="ritual.end()"
             ontouchstart="ritual.start()" 
             ontouchend="ritual.end()">
            <div class="progress-ring" id="progress-ring"></div>
            <span id="ritual-text">BASILI TUT</span>
        </div>
        <p id="ritual-status" style="margin-top: 20px; opacity: 0.7; min-height: 20px;">...</p>
    </div>

    <div id="result-screen" class="screen" style="justify-content: flex-start; padding-top: 40px;">
        <h2 style="color: var(--gold);">âœ¨ FalÄ±n Ã‡Ä±ktÄ± âœ¨</h2>
        
        <div id="result-container" style="width: 100%; padding-bottom: 50px;">
            </div>

        <button class="btn" onclick="app.showScreen('dashboard')">Ana Sayfaya DÃ¶n</button>
        
        <div class="premium-card">
            <h4>ğŸ¤” Kafanda Soru mu Var?</h4>
            <p>Eski sevgilin dÃ¶necek mi? Terfi var mÄ±? Premium al, AI falcÄ±na <b>Ã¶zel soru sor!</b></p>
            <button class="btn btn-gold">Premium'a GeÃ§</button>
        </div>
    </div>

    <div id="account-screen" class="screen">
        <h2>HesabÄ±m</h2>
        <div class="credit-badge" style="width: 80%;">
            Ãœyelik: <span id="membership-type">Standart</span>
        </div>

        <div class="premium-card" style="width: 100%; text-align: left;">
            <h3 style="text-align: center; color: #000;">ğŸ‘‘ Premium AvantajlarÄ±</h3>
            <ul style="font-size: 14px; line-height: 1.6;">
                <li>âœ… <b>Soru Sor:</b> "Ne zaman evleneceÄŸim?" diye direkt sor.</li>
                <li>âœ… <b>Sinastri:</b> Fincan + BurÃ§ uyumuna bak.</li>
                <li>âœ… <b>Beklemek Yok:</b> Ã–ncelikli analiz.</li>
            </ul>
            <button class="btn btn-gold" onclick="alert('Ã–deme sistemine yÃ¶nlendiriliyorsun (Demo)')">Premium Ol (â‚º99/ay)</button>
        </div>

        <button class="btn" style="background: #333; margin-top: 20px;" onclick="app.showScreen('dashboard')">Geri DÃ¶n</button>
        <button class="btn" style="background: transparent; color: #666; font-size: 12px;" onclick="app.resetData()">Verileri SÄ±fÄ±rla (Demo)</button>
    </div>

</div>

<script>
/**
 * SENÄ°N VERDÄ°ÄÄ°N PROMPTA UYGUN MOCK JSON CEVABI
 * Gemini API entegrasyonu yapÄ±lana kadar bu veri dÃ¶necek.
 */
const MOCK_GEMINI_RESPONSE = {
    "genel_yorum": "Ooo gÃ¼zelim hoÅŸ geldin! FincanÄ±na baktÄ±m da iÃ§i bayaÄŸÄ± kabarÄ±k, senin iÃ§ine attÄ±ÄŸÄ±n ÅŸeyler var sanki. Ama yÃ¼reÄŸin o kadar temiz ki, o karanlÄ±klar aydÄ±nlÄ±ÄŸa Ã§Ä±kmak Ã¼zere. Hanenin ortasÄ±nda kocaman bir ferahlÄ±k gÃ¶rÃ¼yorum, sanki bir yÃ¼k kalkacak omuzlarÄ±ndan.",
    "ask_hayati": "Bak ÅŸimdi, fincanÄ±n kulp tarafÄ±nda bir 'E' harfi mi desem, 'M' mi desem bi harf var. GeÃ§miÅŸten biri bu, aklÄ± hala sende kalmÄ±ÅŸ. Ama sen Ã¶nÃ¼ne bakÄ±yorsun kuzum. YakÄ±n zamanda kalbini pÄ±r pÄ±r ettirecek bir heyecan var, ama hemen kapÄ±lma, biraz aÄŸÄ±rdan sat kendini.",
    "kariyer_para": "Eline parÃ§a parÃ§a paralar geÃ§ecek bu ara. Sanki beklediÄŸin bir haber var iÅŸ veya okulla ilgili, o haberin eli kulaÄŸÄ±nda. Ama harcamalarÄ±na dikkat et, su gibi akÄ±p gitmesin paralar.",
    "motto": "KaranlÄ±k gecenin sonu her zaman aydÄ±nlÄ±ktÄ±r, sen parlamaya devam et."
};

/**
 * UYGULAMA MANTIÄI
 */
const app = {
    user: {
        name: '',
        status: '',
        credits: 3,
        lastLoginDate: '',
        isPremium: false
    },

    init: function() {
        // LocalStorage'dan veri Ã§ek
        const savedUser = localStorage.getItem('falUser');
        if (savedUser) {
            this.user = JSON.parse(savedUser);
            this.checkDailyCredits();
            this.showScreen('dashboard');
        }
    },

    login: function() {
        const name = document.getElementById('username').value;
        const status = document.getElementById('status').value;
        
        if(!name || !status) { alert("AdÄ±nÄ± ve durumunu sÃ¶ylemezsen enerjini tutamam!"); return; }

        this.user.name = name;
        this.user.status = status;
        this.checkDailyCredits(); // Ä°lk giriÅŸte kredi kontrolÃ¼
        this.saveUser();
        this.showScreen('dashboard');
    },

    // AÅAMA 3: Kredi Sistemi & Tarih KontrolÃ¼
    checkDailyCredits: function() {
        const today = new Date().toDateString();
        
        // EÄŸer son giriÅŸ tarihi bugÃ¼n deÄŸilse, kredileri yenile
        if (this.user.lastLoginDate !== today) {
            this.user.credits = 3;
            this.user.lastLoginDate = today;
            this.saveUser();
            // Belki burada "GÃ¼naydÄ±n, kredilerin yenilendi!" modalÄ± aÃ§Ä±labilir.
        }
        this.updateUI();
    },

    startUploadProcess: function() {
        // Kredi KontrolÃ¼
        if (this.user.credits <= 0) {
            // AÅAMA 3: Kredi bitti mantÄ±ÄŸÄ±
            alert("Hoppala! BugÃ¼nkÃ¼ nasibini aldÄ±n gÃ¼zelim. Ya yarÄ±nÄ± bekle, ya da reklam izle (YakÄ±nda).");
            // Buraya Premium Upsell modalÄ± aÃ§Ä±lÄ±r normalde
            return;
        }

        // Kredi dÃ¼ÅŸ
        this.user.credits--;
        this.saveUser();
        this.updateUI();

        // FotoÄŸraf seÃ§ilmiÅŸ gibi yapÄ±p RitÃ¼el ekranÄ±na geÃ§
        // (AÅŸama 4: Oyalama SanatÄ±)
        setTimeout(() => {
            this.showScreen('ritual-screen');
        }, 500);
    },

    showResult: function() {
        this.showScreen('result-screen');
        const container = document.getElementById('result-container');
        container.innerHTML = ''; // Temizle

        // JSON verisini sÄ±rayla ve daktilo efektiyle basma
        const sections = [
            { title: "Genel Enerjin", text: MOCK_GEMINI_RESPONSE.genel_yorum },
            { title: "AÅŸk Durumun", text: MOCK_GEMINI_RESPONSE.ask_hayati },
            { title: "Para & Kariyer", text: MOCK_GEMINI_RESPONSE.kariyer_para },
            { title: "Sana Ã–zel MesajÄ±m", text: MOCK_GEMINI_RESPONSE.motto }
        ];

        let delay = 0;
        sections.forEach(sec => {
            // Her bÃ¶lÃ¼m iÃ§in kutu oluÅŸtur
            const box = document.createElement('div');
            box.className = 'result-box';
            box.innerHTML = `<div class="result-title">${sec.title}</div><div class="typewriter-text"></div>`;
            container.appendChild(box);

            // Kutuyu gÃ¶rÃ¼nÃ¼r yap ve yazÄ±yÄ± yazdÄ±r
            setTimeout(() => {
                box.classList.add('show');
                this.typeWriter(box.querySelector('.typewriter-text'), sec.text, 0);
            }, delay);

            // Bir sonraki kutunun baÅŸlama sÃ¼resini hesapla (okuma hÄ±zÄ± simÃ¼lasyonu)
            delay += (sec.text.length * 20) + 1000; 
        });
    },

    // AÅAMA 4: Daktilo Efekti
    typeWriter: function(element, text, index) {
        if (index < text.length) {
            element.innerHTML += text.charAt(index);
            setTimeout(() => {
                this.typeWriter(element, text, index + 1);
            }, 30); // Yazma hÄ±zÄ±
        }
    },

    saveUser: function() {
        localStorage.setItem('falUser', JSON.stringify(this.user));
    },

    updateUI: function() {
        document.getElementById('credit-display').innerText = this.user.credits;
        document.getElementById('membership-type').innerText = this.user.isPremium ? "Premium Ãœye ğŸŒŸ" : "Standart Ãœye";
    },

    showScreen: function(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
        this.updateUI();
    },
    
    goToAccount: function() {
        this.showScreen('account-screen');
    },

    resetData: function() {
        localStorage.removeItem('falUser');
        location.reload();
    }
};

/**
 * AÅAMA 4: RÄ°TÃœEL (BASILI TUTMA OYUNU)
 */
const ritual = {
    timer: null,
    progress: 0,
    btn: document.getElementById('ritual-btn'),
    ring: document.getElementById('progress-ring'),
    status: document.getElementById('ritual-status'),
    isComplete: false,

    start: function() {
        if (this.isComplete) return;
        
        this.btn.classList.add('holding');
        this.ring.style.display = 'block';
        this.status.innerText = "Enerjin fincana akÄ±yor... BÄ±rakma...";
        
        // Haptic Feedback (Mobil cihazlarda titreÅŸim)
        if (navigator.vibrate) navigator.vibrate(50);

        this.timer = setInterval(() => {
            this.progress += 2; // Dolma hÄ±zÄ±
            
            // Renk ve opaklÄ±k deÄŸiÅŸimi (GÃ¶rsel Efekt)
            this.btn.style.boxShadow = `0 0 ${30 + this.progress}px rgba(233, 69, 96, ${this.progress/100})`;

            if (this.progress >= 100) {
                this.complete();
            }
        }, 50);
    },

    end: function() {
        if (this.isComplete) return;

        clearInterval(this.timer);
        this.btn.classList.remove('holding');
        this.ring.style.display = 'none';
        
        // TamamlanmadÄ±ysa sÄ±fÄ±rla
        this.progress = 0;
        this.status.innerText = "Enerji koptu! Tekrar dene.";
        this.btn.style.boxShadow = "0 0 30px rgba(233, 69, 96, 0.5)";
    },

    complete: function() {
        clearInterval(this.timer);
        this.isComplete = true;
        this.status.innerText = "Enerji AktarÄ±mÄ± BaÅŸarÄ±lÄ±!";
        this.btn.innerHTML = "âœ¨";
        this.btn.style.background = "#ffd700";
        this.btn.style.color = "#000";
        
        if (navigator.vibrate) navigator.vibrate([100, 50, 100]); // BaÅŸarÄ± titreÅŸimi

        // SonuÃ§ ekranÄ±na yÃ¶nlendir
        setTimeout(() => {
            app.showResult();
            // RitÃ¼eli sÄ±fÄ±rla (bir sonraki fal iÃ§in)
            setTimeout(() => { this.resetRitual(); }, 2000);
        }, 1000);
    },

    resetRitual: function() {
        this.isComplete = false;
        this.progress = 0;
        this.btn.innerHTML = '<div class="progress-ring" id="progress-ring"></div><span id="ritual-text">BASILI TUT</span>';
        this.btn.style.background = 'radial-gradient(circle, #e94560 0%, #1a1a2e 70%)';
        this.btn.style.color = 'white';
        this.ring = document.getElementById('progress-ring'); // Element yeniden oluÅŸturulduÄŸu iÃ§in referansÄ± gÃ¼ncelle
        this.status.innerText = "...";
    }
};

// BaÅŸlangÄ±Ã§
app.init();

</script>

</body>
</html>
